<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>CPBC Faith & Media Tour | ì‹ ì•™ê³¼ ë¯¸ë””ì–´ ì²´í—˜ ê²¬í•™</title>
<style>
  :root{
    --brand:#2d4ea3; --brand2:#5c7ae0;
    --bg:#f6f8fb; --card:#fff; --txt:#1b2333; --muted:#5d6b86;
    --radius:16px; --shadow:0 10px 28px rgba(0,0,0,.08);
  }
  *{box-sizing:border-box}
  html,body{margin:0;background:var(--bg);color:var(--txt);font-family:"Noto Sans KR",system-ui,Segoe UI,Arial,sans-serif;line-height:1.6}
  a{color:inherit}
  header{
    position:sticky;top:0;z-index:40;background:linear-gradient(120deg,var(--brand),#1b2a6b);
    color:#fff;padding:14px 16px;box-shadow:0 2px 12px rgba(0,0,0,.12)
  }
  .wrap{max-width:1100px;margin:0 auto;display:flex;align-items:center;gap:12px}
  h1{margin:0;font-size:clamp(18px,2.2vw,24px);font-weight:800}
  nav.pc{margin-left:auto;display:flex;gap:10px}
  nav.pc a,.admin-btn{
    color:#fff;text-decoration:none;padding:8px 12px;border-radius:999px;border:1px solid rgba(255,255,255,.28);
    font-weight:700;font-size:14px
  }
  .admin-btn{cursor:pointer;background:rgba(255,255,255,.06)}
  .card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:18px}
  .pill{display:inline-block;padding:2px 10px;border-radius:999px;background:#eef2ff;color:#334155;font-weight:800;font-size:12px}
  .list li{margin:6px 0}
  .note{background:#f1f5ff;border:1px solid #dbe3ff;border-radius:12px;padding:10px 12px;color:#233056}
  /* ====== ë°ìŠ¤í¬í†± ë ˆì´ì•„ì›ƒ ====== */
  main.desktop{max-width:1100px;margin:26px auto;padding:0 16px}
  .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:14px}
  h2{font-size:20px;margin:10px 0 14px;border-left:6px solid var(--brand);padding-left:10px}
  /* ====== ëª¨ë°”ì¼: ê°€ë¡œ ìŠ¤ì™€ì´í”„ ìŠ¬ë¼ì´ë“œ ====== */
  @media (max-width:900px){
    nav.pc{display:none}
    main.desktop{display:none}
    header{padding:12px 14px}
    h1{font-size:18px}
    .slides{
      scroll-snap-type:x mandatory; overflow-x:auto; overflow-y:hidden; white-space:nowrap;
      display:flex; -webkit-overflow-scrolling:touch; gap:16px; padding:16px; scroll-behavior:smooth;
    }
    .slide{
      scroll-snap-align:start; flex:0 0 calc(100vw - 32px); /* ì¢Œìš° ì—¬ë°± ì œì™¸ í’€í­ */
      background:transparent; display:flex; flex-direction:column; gap:12px
    }
    .slide .card{padding:16px; border-radius:18px}
    .slide h2{font-size:18px}
    .spacer{height:74px} /* bottom bar ê³µê°„ í™•ë³´ */
    /* í•˜ë‹¨ íƒ­ë°” */
    .tabbar{
      position:fixed; left:0; right:0; bottom:0; z-index:45;
      display:flex; justify-content:space-around; align-items:center;
      background:#fff; box-shadow:0 -8px 18px rgba(0,0,0,.08); padding:8px env(safe-area-inset-left) 10px env(safe-area-inset-right);
      border-top:1px solid #e9edf5
    }
    .tabbar button{
      appearance:none; border:none; background:none; padding:8px 10px; border-radius:12px; font-weight:800; color:#334155;
      display:flex; flex-direction:column; align-items:center; gap:4px; min-width:56px
    }
    .tabbar button.active{background:#eef2ff; color:#1d4ed8}
    .tabbar .ico{font-size:18px; line-height:1}
    /* í˜ì´ì§€ ì  */
    .dots{position:fixed; left:0; right:0; bottom:58px; display:flex; justify-content:center; gap:8px; z-index:44}
    .dot{width:8px; height:8px; border-radius:999px; background:#d7dce6}
    .dot.active{background:#2d4ea3; transform:scale(1.25)}
    /* í„°ì¹˜ íƒ€ê²Ÿ ê°œì„  */
    .btn{padding:13px 16px; border-radius:12px; border:none; font-weight:800}
    .btn-primary{background:var(--brand); color:#fff}
    .btn-ghost{background:#eef2ff; color:#1e293b}
  }
  /* ê³µìš© í¼ */
  form label{display:block;margin:12px 0 6px;font-weight:700}
  form input[type="text"],form input[type="tel"],form input[type="email"],form textarea,form select{
    width:100%;padding:12px;border:1px solid #d7dce6;border-radius:12px;font-size:15px;outline:none;transition:.2s
  }
  form input:focus,form select:focus,form textarea:focus{border-color:var(--brand);box-shadow:0 0 0 4px rgba(45,78,163,.12)}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  @media (max-width:900px){ .row{grid-template-columns:1fr} }
  /* ê´€ë¦¬ì/ëª¨ë‹¬ */
  dialog{border:none;border-radius:18px;box-shadow:0 30px 60px rgba(0,0,0,.25);max-width:980px;width:calc(100% - 24px);padding:0}
  .dlg-head{display:flex;justify-content:space-between;align-items:center;padding:16px 18px;border-bottom:1px solid #e7ebf5}
  .dlg-body{padding:18px}
  .table{width:100%;border-collapse:separate;border-spacing:0 8px}
  .table th{font-size:13px;text-align:left;color:#475569}
  .table td,.table th{padding:10px 10px}
  .rowcard{background:#fff;border:1px solid #e7ebf5;border-radius:12px}
  .status{font-size:12px;font-weight:900;padding:6px 10px;border-radius:999px}
  .s-new{background:#eef2ff;color:#1d4ed8}.s-ok{background:#e7f8ef;color:#166534}.s-rej{background:#fdecec;color:#b91c1c}
  .mini{font-size:12px;color:#64748b}
  .toolbar{display:flex;gap:8px;flex-wrap:wrap;margin:10px 0 6px}
  .search{flex:1 1 220px}
</style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>CPBC Faith & Media Tour | ì‹ ì•™ê³¼ ë¯¸ë””ì–´ ì²´í—˜ ê²¬í•™</h1>
      <nav class="pc">
        <a href="#s-intro">ì†Œê°œ</a><a href="#s-course">ì½”ìŠ¤</a><a href="#s-guide">ìš´ì˜ì•ˆë‚´</a>
        <a href="#s-holy">ì£¼ë³€ì„±ì§€</a><a href="#s-visit">ì˜¤ì‹œëŠ” ê¸¸</a><a href="#s-apply">ì‹ ì²­</a>
      </nav>
      <button class="admin-btn" id="btnAdmin">ê´€ë¦¬ì ëª¨ë“œ</button>
    </div>
  </header>

  <!-- ë°ìŠ¤í¬í†±: ê¸°ì¡´ ê·¸ë¦¬ë“œ(ìš”ì•½) -->
  <main class="desktop" id="desktop">
    <section id="s-intro" class="grid">
      <div class="card" style="grid-column:span 7">
        <h2>ì†Œê°œ</h2>
        <p>ê°€í†¨ë¦­í‰í™”ë°©ì†¡(CPBC)ì€ ì‚¬ë‘ê³¼ ë‚˜ëˆ”ì˜ ê°€ì¹˜ë¥¼ ì‹¤ì²œí•˜ë©° ë³µìŒì˜ ë©”ì‹œì§€ë¥¼ ì „í•˜ëŠ” ë¯¸ë””ì–´ ì‚¬ë„ì§ì„ ìˆ˜í–‰í•˜ê³  ìˆìŠµë‹ˆë‹¤. CPBC ê²¬í•™ í”„ë¡œê·¸ë¨ì€ ë°©ì†¡ í˜„ì¥ì„ ì§ì ‘ ì²´í—˜í•˜ê³ , ì‹ ì•™ê³¼ ë¯¸ë””ì–´ê°€ í•¨ê»˜í•˜ëŠ” íŠ¹ë³„í•œ ì‹œê°„ì„ ìƒì‹œë¡œ ì œê³µí•©ë‹ˆë‹¤.</p>
        <p>íŠ¹íˆ ë³¸ì‚¬ì— ëª¨ì‹  <strong>ì„± ì¹´ë¥¼ë¡œ ì•„ì¿ í‹°ìŠ¤ ì„±ìƒ</strong> ì•ì—ì„œ ë””ì§€í„¸ ì‹œëŒ€ì˜ ì‹ ì•™ì¸ì˜ ì—­í• ì„ í•¨ê»˜ ë°°ìš°ê³  ë¬µìƒí•©ë‹ˆë‹¤.</p>
        <p><button class="btn btn-ghost" id="openCarlo">[ì„± ì¹´ë¥¼ë¡œ ì•„ì¿ í‹°ìŠ¤ ì„±ì¸ì˜ ì˜ë¯¸]</button></p>
      </div>
      <div class="card" style="grid-column:span 5">
        <h2>í•µì‹¬ ì•ˆë‚´</h2>
        <ul class="list">
          <li><span class="pill">ëŒ€ìƒ</span> ì´ˆë“±í•™ìƒ ì´ìƒ / êµíšŒÂ·êµìœ¡Â·ê³µê³µÂ·ì‹œë¯¼ë‹¨ì²´</li>
          <li><span class="pill">ì¸ì›</span> 10~15ëª…</li>
          <li><span class="pill">ì¼ì •</span> ë§¤ì£¼ í™”/ê¸ˆ, ì˜¤ì „ 10ì‹œ Â· ì˜¤í›„ 2ì‹œ</li>
          <li><span class="pill">ì¥ì†Œ</span> ì„œìš¸ ì¤‘êµ¬ ì‚¼ì¼ëŒ€ë¡œ 330</li>
          <li><span class="pill">ë¹„ìš©</span> ë¬´ë£Œ</li>
          <li class="note">â€» ë°©ë¬¸ í¬ë§ì¼ <strong>ìµœì†Œ 30ì¼ ì „</strong> ì‹ ì²­ í•„ìˆ˜, í™•ì¸ í›„ ìµœì¢… í™•ì •</li>
        </ul>
      </div>
    </section>
    <section id="s-course" class="grid">
      <div class="card" style="grid-column:span 12">
        <h2>ê²¬í•™ ì½”ìŠ¤ (ì•½ 1~1.5ì‹œê°„)</h2>
        <div class="grid">
          <div class="card" style="grid-column:span 4"><h3>â‘  ì—­ì‚¬ ì „ì‹œì‹¤</h3><p>ì„¤ë¦½ ë°°ê²½Â·ì‚¬ëª…, CPBC ì†Œê°œ ì˜ìƒ</p></div>
          <div class="card" style="grid-column:span 4"><h3>â‘¡ ì„±ìƒ ì• ì²´í—˜</h3><p>ì„±ì¸ì˜ ì‚¶Â·ì˜ì„±, ë¬µìƒ, ë””ì§€í„¸ ì‹ ì•™</p></div>
          <div class="card" style="grid-column:span 4"><h3>â‘¢ ìŠ¤íŠœë””ì˜¤</h3><p>ì¹´ë©”ë¼/ì˜¤ë””ì˜¤ ì²´í—˜</p></div>
        </div>
      </div>
    </section>
    <section id="s-guide" class="grid">
      <div class="card" style="grid-column:span 12">
        <h2>ìš´ì˜ ì•ˆë‚´</h2>
        <ul class="list">
          <li>ëŒ€ìƒ: ì´ˆë“±í•™ìƒ ì´ìƒ / êµíšŒê¸°ê´€Â·êµìœ¡ê¸°ê´€Â·ê³µê³µê¸°ê´€Â·ì‹œë¯¼ë‹¨ì²´ ë“±</li>
          <li>ì¸ì›: 10~15ëª… ì†Œê·œëª¨ ê·¸ë£¹</li>
          <li>ì¼ì •: ë§¤ì£¼ í™”Â·ê¸ˆ (ì˜¤ì „ 10ì‹œ/ì˜¤í›„ 2ì‹œ)</li>
          <li>ì¥ì†Œ: ì„œìš¸ì‹œ ì¤‘êµ¬ ì‚¼ì¼ëŒ€ë¡œ 330</li>
          <li>ë¹„ìš©: ë¬´ë£Œ</li>
          <li>ì‹ ì²­: ìµœì†Œ 30ì¼ ì „ ì ‘ìˆ˜ â†’ ì¼ì • í™•ì •</li>
        </ul>
      </div>
    </section>
    <section id="s-holy" class="grid">
      <div class="card" style="grid-column:span 12">
        <h2>ì£¼ë³€ ì„±ì§€ ì•ˆë‚´</h2>
        <div class="grid" style="grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:14px">
          <div class="card"><strong><a href="https://www.mdsd.or.kr/" target="_blank" rel="noopener">ëª…ë™ëŒ€ì„±ë‹¹</a></strong><p class="mini">ë„ë³´ 15~20ë¶„</p></div>
          <div class="card"><strong><a href="http://www.yakhyeon.or.kr" target="_blank" rel="noopener">ì•½í˜„ì„±ë‹¹</a></strong><p class="mini">1892, ë²½ëŒ ì„±ë‹¹</p></div>
          <div class="card"><strong><a href="https://www.seosomun.org" target="_blank" rel="noopener">ì„œì†Œë¬¸ì„±ì§€ì—­ì‚¬ë°•ë¬¼ê´€</a></strong><p class="mini">ìˆœêµ ì—­ì‚¬Â·í•˜ëŠ˜ê´‘ì¥</p></div>
          <div class="card"><strong><a href="http://saenamteo.or.kr" target="_blank" rel="noopener">ìƒˆë‚¨í„° ìˆœêµì„±ì§€</a></strong><p class="mini">ê¸°ë…ê´€ ìš´ì˜</p></div>
        </div>
      </div>
    </section>
    <section id="s-visit" class="grid">
      <div class="card" style="grid-column:span 12">
        <h2>ì˜¤ì‹œëŠ” ê¸¸</h2>
        <ul class="list">
          <li>ì§€í•˜ì² : 2í˜¸ì„  ì„ì§€ë¡œ3ê°€(12ë²ˆ) 5ë¶„ / 3í˜¸ì„  ì¶©ë¬´ë¡œ(7ë²ˆ) 7ë¶„</li>
          <li>ë²„ìŠ¤: ì„ì§€ë¡œì…êµ¬/í‡´ê³„ë¡œ ì¸ê·¼</li>
          <li>ìŠ¹ìš©ì°¨: ì¸ì†”ì 1ëŒ€ ë¬´ë£Œ(ë²„ìŠ¤/ìŠ¹í•© ë¶ˆê°€)</li>
        </ul>
      </div>
    </section>
    <section id="s-apply" class="grid">
      <div class="card" style="grid-column:span 12">
        <h2>ì‹ ì²­ì„œ ì‘ì„±</h2>
        <!-- í¼ì€ ì•„ë˜ ëª¨ë°”ì¼ ì„¹ì…˜ê³¼ ë™ì¼ ìš”ì†Œ ì‚¬ìš© -->
        <div id="formMountDesktop"></div>
      </div>
    </section>
  </main>

  <!-- ëª¨ë°”ì¼ ìŠ¬ë¼ì´ë“œ -->
  <div class="slides" id="slides" aria-label="CPBC íˆ¬ì–´ ìŠ¬ë¼ì´ë“œ">
    <!-- 1: ì†Œê°œ -->
    <section class="slide" data-idx="0">
      <div class="card">
        <h2>ì†Œê°œ</h2>
        <p>ê°€í†¨ë¦­í‰í™”ë°©ì†¡(CPBC)ì€ ì‚¬ë‘ê³¼ ë‚˜ëˆ”ì˜ ê°€ì¹˜ë¥¼ ì‹¤ì²œí•˜ë©° ë³µìŒì˜ ë©”ì‹œì§€ë¥¼ ì „í•˜ëŠ” ë¯¸ë””ì–´ ì‚¬ë„ì§ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. ë³¸ ê²¬í•™ì€ ë°©ì†¡ í˜„ì¥ì„ ì²´í—˜í•˜ê³  ì‹ ì•™ê³¼ ë¯¸ë””ì–´ê°€ ë§Œë‚˜ëŠ” ì‹œê°„ì„ ì œê³µí•©ë‹ˆë‹¤.</p>
        <p>ë³¸ì‚¬ <strong>ì„± ì¹´ë¥¼ë¡œ ì•„ì¿ í‹°ìŠ¤ ì„±ìƒ</strong> ì•ì—ì„œ ë””ì§€í„¸ ì‹œëŒ€ ì‹ ì•™ì¸ì˜ ì‚¶ì„ í•¨ê»˜ ë°°ìš°ê³  ë¬µìƒí•©ë‹ˆë‹¤.</p>
        <button class="btn btn-ghost" id="openCarloM">[ì„± ì¹´ë¥¼ë¡œ ì•„ì¿ í‹°ìŠ¤ ì„±ì¸ì˜ ì˜ë¯¸]</button>
      </div>
      <div class="card">
        <h2>í•µì‹¬ ì•ˆë‚´</h2>
        <ul class="list">
          <li><span class="pill">ëŒ€ìƒ</span> ì´ˆë“± ì´ìƒ / êµíšŒÂ·êµìœ¡Â·ê³µê³µÂ·ì‹œë¯¼ë‹¨ì²´</li>
          <li><span class="pill">ì¸ì›</span> 10~15ëª…</li>
          <li><span class="pill">ì¼ì •</span> í™”Â·ê¸ˆ / 10:00Â·14:00</li>
          <li><span class="pill">ì¥ì†Œ</span> ì„œìš¸ ì¤‘êµ¬ ì‚¼ì¼ëŒ€ë¡œ 330</li>
          <li><span class="pill">ë¹„ìš©</span> ë¬´ë£Œ</li>
        </ul>
      </div>
    </section>

    <!-- 2: ì½”ìŠ¤ -->
    <section class="slide" data-idx="1">
      <div class="card"><h2>ê²¬í•™ ì½”ìŠ¤ (ì•½ 1~1.5h)</h2></div>
      <div class="card"><h3>â‘  ì—­ì‚¬ ì „ì‹œì‹¤</h3><p>CPBC ì„¤ë¦½ ë°°ê²½Â·ì‚¬ëª…, ì†Œê°œ ì˜ìƒ</p></div>
      <div class="card"><h3>â‘¡ ì„±ìƒ ì• ì²´í—˜</h3><p>ì„±ì¸ì˜ ì‚¶/ì˜ì„±, ë¬µìƒ, ë””ì§€í„¸ ì‹ ì•™</p></div>
      <div class="card"><h3>â‘¢ ìŠ¤íŠœë””ì˜¤</h3><p>ì¹´ë©”ë¼Â·ì˜¤ë””ì˜¤ ì¥ë¹„ ì²´í—˜</p></div>
    </section>

    <!-- 3: ìš´ì˜ ì•ˆë‚´ -->
    <section class="slide" data-idx="2">
      <div class="card">
        <h2>ìš´ì˜ ì•ˆë‚´</h2>
        <ul class="list">
          <li>ëŒ€ìƒ: ì´ˆë“±í•™ìƒ ì´ìƒ ë‹¨ì²´</li>
          <li>ì¸ì›: 10~15ëª… ì†Œê·œëª¨</li>
          <li>ì¼ì •: ë§¤ì£¼ í™”Â·ê¸ˆ (10ì‹œ/14ì‹œ)</li>
          <li>ì¥ì†Œ: ì„œìš¸ ì¤‘êµ¬ ì‚¼ì¼ëŒ€ë¡œ 330</li>
          <li>ë¹„ìš©: ë¬´ë£Œ</li>
          <li class="note">â€» í¬ë§ì¼ ìµœì†Œ 30ì¼ ì „ ì‹ ì²­ Â· ë‹´ë‹¹ì í™•ì¸ í›„ í™•ì •</li>
        </ul>
      </div>
    </section>

    <!-- 4: ì£¼ë³€ ì„±ì§€ -->
    <section class="slide" data-idx="3">
      <div class="card"><h2>ì£¼ë³€ ì„±ì§€ ì•ˆë‚´</h2></div>
      <div class="card"><strong><a href="https://www.mdsd.or.kr/" target="_blank" rel="noopener">ëª…ë™ëŒ€ì„±ë‹¹</a></strong><p class="mini">ë„ë³´ 15~20ë¶„</p></div>
      <div class="card"><strong><a href="http://www.yakhyeon.or.kr" target="_blank" rel="noopener">ì•½í˜„ì„±ë‹¹</a></strong><p class="mini">1892 ë²½ëŒ ì„±ë‹¹</p></div>
      <div class="card"><strong><a href="https://www.seosomun.org" target="_blank" rel="noopener">ì„œì†Œë¬¸ì„±ì§€ì—­ì‚¬ë°•ë¬¼ê´€</a></strong><p class="mini">ìˆœêµ ì—­ì‚¬Â·í•˜ëŠ˜ê´‘ì¥</p></div>
      <div class="card"><strong><a href="http://saenamteo.or.kr" target="_blank" rel="noopener">ìƒˆë‚¨í„° ìˆœêµì„±ì§€</a></strong><p class="mini">ê¸°ë…ê´€ ìš´ì˜</p></div>
    </section>

    <!-- 5: ì˜¤ì‹œëŠ” ê¸¸ -->
    <section class="slide" data-idx="4">
      <div class="card">
        <h2>ì˜¤ì‹œëŠ” ê¸¸</h2>
        <ul class="list">
          <li>ì§€í•˜ì² : 2í˜¸ì„  ì„ì§€ë¡œ3ê°€(12ë²ˆ) 5ë¶„ / 3í˜¸ì„  ì¶©ë¬´ë¡œ(7ë²ˆ) 7ë¶„</li>
          <li>ë²„ìŠ¤: ì„ì§€ë¡œì…êµ¬/í‡´ê³„ë¡œ ì¸ê·¼</li>
          <li>ì°¨ëŸ‰: ì¸ì†”ì 1ëŒ€ ë¬´ë£Œ(ë²„ìŠ¤/ìŠ¹í•© ë¶ˆê°€)</li>
        </ul>
      </div>
    </section>

    <!-- 6: ì‹ ì²­ì„œ -->
    <section class="slide" data-idx="5">
      <div class="card"><h2>ì‹ ì²­ì„œ ì‘ì„±</h2><div id="formMountMobile"></div></div>
      <div class="spacer"></div>
    </section>
  </div>

  <!-- í˜ì´ì§€ ì  -->
  <div class="dots" id="dots" aria-hidden="true"></div>

  <!-- í•˜ë‹¨ íƒ­ë°” -->
  <div class="tabbar" id="tabbar" role="tablist" aria-label="ì„¹ì…˜ ë‚´ë¹„ê²Œì´ì…˜">
    <button data-go="0" class="active" role="tab" aria-selected="true"><span class="ico">ğŸ </span><span>ì†Œê°œ</span></button>
    <button data-go="1" role="tab"><span class="ico">ğŸ§­</span><span>ì½”ìŠ¤</span></button>
    <button data-go="2" role="tab"><span class="ico">ğŸ“‹</span><span>ì•ˆë‚´</span></button>
    <button data-go="3" role="tab"><span class="ico">â›ª</span><span>ì„±ì§€</span></button>
    <button data-go="4" role="tab"><span class="ico">ğŸ—ºï¸</span><span>ì˜¤ì‹œëŠ”ê¸¸</span></button>
    <button data-go="5" role="tab"><span class="ico">ğŸ“</span><span>ì‹ ì²­</span></button>
  </div>

  <!-- ì„± ì¹´ë¥¼ë¡œ ì•„ì¿ í‹°ìŠ¤ ëª¨ë‹¬ -->
  <dialog id="carloDlg">
    <div class="dlg-head">
      <strong>ì„± ì¹´ë¥¼ë¡œ ì•„ì¿ í‹°ìŠ¤ (1991â€“2006)</strong>
      <button class="admin-btn" onclick="document.getElementById('carloDlg').close()">ë‹«ê¸° âœ•</button>
    </div>
    <div class="dlg-body">
      <p>ì„± ì¹´ë¥¼ë¡œ ì•„ì¿ í‹°ìŠ¤ëŠ” ì „ ì„¸ê³„ ì„±ì²´ ê¸°ì ì„ ì˜¨ë¼ì¸ìœ¼ë¡œ ì•„ì¹´ì´ë¸Œí™”í•œ ë””ì§€í„¸ ë³µìŒí™”ì˜ ëª¨ë²”ì…ë‹ˆë‹¤. CPBCëŠ” ì„±ì¸ì„ ì œ2ì£¼ë³´ì„±ì¸ìœ¼ë¡œ ëª¨ì‹œê³  ì„±ìƒì„ í†µí•´ ì‹ ì•™ê³¼ ë¯¸ë””ì–´ ì‚¬ë„ì§ì˜ ë³¸ë³´ê¸°ë¥¼ ì‚¼ê³  ìˆìŠµë‹ˆë‹¤.</p>
    </div>
  </dialog>

  <!-- ê´€ë¦¬ì íŒ¨ë„ -->
  <dialog id="adminDlg">
    <div class="dlg-head">
      <strong>ê´€ë¦¬ì íŒ¨ë„ Â· CPBC ê²¬í•™ ì‹ ì²­ ê´€ë¦¬</strong>
      <button class="admin-btn" onclick="document.getElementById('adminDlg').close()">ë‹«ê¸° âœ•</button>
    </div>
    <div class="dlg-body">
      <details open>
        <summary>ì ‘ì†</summary>
        <div style="display:flex;gap:10px;align-items:center;margin:10px 0 6px">
          <label>PIN</label>
          <input type="password" id="pinInput" placeholder="cpbc2025" />
          <button class="admin-btn" id="btnUnlock" style="background:#eef2ff;color:#1e293b;border:1px solid #d7dce6">ì ‘ì†</button>
          <span id="pinMsg" class="mini"></span>
        </div>
      </details>
      <div id="adminArea" style="display:none">
        <div class="toolbar">
          <input class="search" type="search" id="q" placeholder="ê²€ìƒ‰: ë‹¨ì²´/ì¸ì†”ì/ì—°ë½ì²˜/ì´ë©”ì¼/ë‚ ì§œ" />
          <select id="statusFilter">
            <option value="">ìƒíƒœ(ì „ì²´)</option><option value="ì‹ ê·œ">ì‹ ê·œ</option><option value="í™•ì •">í™•ì •</option><option value="ë°˜ë ¤">ë°˜ë ¤</option>
          </select>
          <div style="margin-left:auto">
            <button class="admin-btn" id="btnExport">CSV ë‚´ë³´ë‚´ê¸°</button>
            <button class="admin-btn" id="btnClear">ì „ì²´ ì‚­ì œ</button>
          </div>
        </div>
        <table class="table" id="tbl">
          <thead><tr><th>ìƒíƒœ</th><th>ì‹ ì²­ì¼ì‹œ</th><th>í¬ë§ì¼/ì‹œê°„</th><th>ë‹¨ì²´/ì†Œì†</th><th>ì¸ì†”ì</th><th>ì—°ë½ì²˜/ì´ë©”ì¼</th><th>ì°¨ëŸ‰</th><th></th></tr></thead>
          <tbody id="tbody"></tbody>
        </table>
      </div>
    </div>
  </dialog>

<script>
/* ===== ì„¤ì •/ìŠ¤í† ë¦¬ì§€ ===== */
const ADMIN_PIN='cpbc2025';
const STORAGE_KEY='cpbc_tour_submissions_v1';
const $=(s,r=document)=>r.querySelector(s); const $$=(s,r=document)=>[...r.querySelectorAll(s)];
const fmt=(d)=>new Date(d).toLocaleString('ko-KR',{hour12:false});
const todaySeoul=()=>{const n=new Date(),u=n.getTime()+n.getTimezoneOffset()*60000;return new Date(u+9*3600000)}
function loadAll(){try{return JSON.parse(localStorage.getItem(STORAGE_KEY)||'[]')}catch(e){return[]}}
function saveAll(v){localStorage.setItem(STORAGE_KEY,JSON.stringify(v))}
function addSubmission(d){const L=loadAll();L.unshift(d);saveAll(L)}
function escapeHtml(s){return (s||'').replace(/[&<>"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]))}

/* ===== ë‚ ì§œ(30ì¼ ì´í›„ & í™”/ê¸ˆ) ===== */
function buildDateOptions(select){
  select.innerHTML='';
  const now=todaySeoul(), start=new Date(now.getFullYear(),now.getMonth(),now.getDate()); start.setDate(start.getDate()+30);
  const end=new Date(start); end.setMonth(end.getMonth()+6);
  let cur=new Date(start), cnt=0;
  while(cur<=end){
    const d=cur.getDay(); if(d===2||d===5){
      const y=cur.getFullYear(), m=String(cur.getMonth()+1).padStart(2,'0'), dd=String(cur.getDate()).padStart(2,'0');
      const opt=document.createElement('option'); opt.value=`${y}-${m}-${dd}`; opt.textContent=`${y}-${m}-${dd} (${['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '][d]})`;
      select.appendChild(opt); cnt++;
    }
    cur.setDate(cur.getDate()+1);
  }
  if(!cnt){ const o=document.createElement('option'); o.value=''; o.textContent='ì„ íƒ ê°€ëŠ¥í•œ ë‚ ì§œ ì—†ìŒ'; select.appendChild(o) }
}
function validateDateRule(val){
  if(!val) return false; const d=new Date(val+'T00:00:00+09:00'), now=todaySeoul();
  const diff=Math.floor((d-now)/(1000*3600*24)), day=d.getDay(); return diff>=30 && (day===2||day===5);
}

/* ===== í¼ ì»´í¬ë„ŒíŠ¸ (ì¤‘ë³µmount: ë°ìŠ¤í¬í†±/ëª¨ë°”ì¼) ===== */
function createForm(){
  const wrap=document.createElement('div');
  wrap.innerHTML=`
  <form id="applyForm" novalidate>
    <div class="row">
      <div><label>ë‹¨ì²´ëª… *</label><input type="text" name="org" required placeholder="ì˜ˆ: ì„œìš¸ â—‹â—‹ì´ˆ 5í•™ë…„"></div>
      <div><label>ì†Œì†(ë³¸ë‹¹/í•™êµ/ê¸°ê´€ ë“±) *</label><input type="text" name="aff" required></div>
    </div>
    <label>ì°¸ê°€ ì¸ì› *</label><input type="text" name="headcount" required placeholder="ì˜ˆ: ì´ 15ëª… / í•™ìƒ 13, ì¸ì†”ì 2">

    <div class="row">
      <div><label>ëŒ€í‘œ ì¸ì†”ì ì„±ëª… *</label><input type="text" name="leader" required></div>
      <div><label>ì—°ë½ì²˜(íœ´ëŒ€í°) *</label><input type="tel" name="phone" required pattern="^0\\d{1,2}-?\\d{3,4}-?\\d{4}$" placeholder="010-1234-5678"></div>
    </div>
    <div class="row">
      <div><label>ì´ë©”ì¼ *</label><input type="email" name="email" required placeholder="example@cpbc.co.kr"></div>
      <div>
        <label>ì°¨ëŸ‰ ì´ìš© ì—¬ë¶€ *</label>
        <select name="carUse" id="carUse" required><option value="">ì„ íƒ</option><option>ì˜ˆ</option><option>ì•„ë‹ˆì˜¤</option></select>
      </div>
    </div>
    <div id="carPlateWrap" style="display:none">
      <label>ì°¨ëŸ‰ë²ˆí˜¸ (ì°¨ëŸ‰ ì´ìš© ì‹œ)</label><input type="text" name="carNo" placeholder="12ê°€3456">
    </div>

    <div class="row">
      <div>
        <label>í¬ë§ ë‚ ì§œ *</label>
        <select name="date" id="dateSelect" required></select>
        <div class="mini">ì˜¤ëŠ˜ ê¸°ì¤€ 30ì¼ ì´í›„, í™”/ê¸ˆë§Œ ì„ íƒ ê°€ëŠ¥</div>
      </div>
      <div>
        <label>í¬ë§ ì‹œê°„ *</label>
        <select name="time" required><option>ì˜¤ì „ 10ì‹œ</option><option>ì˜¤í›„ 2ì‹œ</option></select>
      </div>
    </div>

    <label>ì°¸ê°€ ëŒ€ìƒ *(ë³µìˆ˜ ì„ íƒ)</label>
    <div class="row">
      <label><input type="checkbox" name="target" value="í•™ìƒ ë‹¨ì²´"> ì´ˆë“±í•™ìƒ ì´ìƒ í•™ìƒ ë‹¨ì²´</label>
      <label><input type="checkbox" name="target" value="êµíšŒ/ë³¸ë‹¹"> êµíšŒê¸°ê´€ / ë³¸ë‹¹ ë‹¨ì²´</label>
      <label><input type="checkbox" name="target" value="êµìœ¡ê¸°ê´€"> êµìœ¡ê¸°ê´€</label>
      <label><input type="checkbox" name="target" value="ê³µê³µ/ì‹œë¯¼"> ê³µê³µê¸°ê´€ / ì‹œë¯¼ë‹¨ì²´</label>
      <label><input type="checkbox" name="target" value="ê¸°íƒ€"> ê¸°íƒ€</label>
    </div>

    <label>íŠ¹ë³„ ìš”ì²­ì‚¬í•­</label>
    <textarea name="request" rows="4" placeholder="ì•Œë ˆë¥´ê¸°, ì´ë™ ë³´ì¡°, ì‚¬ì§„ ì´¬ì˜ ë“±"></textarea>

    <label>ì•ˆë‚´ ë° ë™ì˜ *</label>
    <div class="note" style="margin:.4rem 0 .6rem">
      Â· í”„ë¡œê·¸ë¨ì€ ë¬´ë£Œì…ë‹ˆë‹¤.<br>Â· ë‚´ë¶€ ì‚¬ì •/ê³µíœ´ì¼ì—” ì¼ì •ì´ ì¡°ì •ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
      Â· ì¸ì†”ì 1ì¸ ë™í–‰ í•„ìˆ˜, ë°©ì†¡ ì¤‘ ì‚¬ì§„ ì´¬ì˜ ì œí•œ ê°€ëŠ¥.<br>
      Â· í¬ë§ì¼ ìµœì†Œ 30ì¼ ì „ ì‹ ì²­ Â· ë‹´ë‹¹ì í™•ì¸ í›„ ìµœì¢… í™•ì •ë©ë‹ˆë‹¤.
    </div>
    <label><input type="checkbox" name="agree" required> ë„¤, ìœ„ ë‚´ìš©ì„ í™•ì¸í•˜ì˜€ìŠµë‹ˆë‹¤.</label>

    <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:14px">
      <button type="submit" class="btn btn-primary">ì‹ ì²­ì„œ ì œì¶œ</button>
      <button type="button" class="btn btn-ghost" id="btnReset">ì‘ì„± ì´ˆê¸°í™”</button>
    </div>
    <div id="submitMsg" class="note" style="display:none;margin-top:10px"></div>
  </form>`;
  // ë™ì‘ ë°”ì¸ë”©
  const form=$('#applyForm',wrap);
  const carUse=$('#carUse',wrap), carWrap=$('#carPlateWrap',wrap), dateSel=$('#dateSelect',wrap);
  buildDateOptions(dateSel);
  carUse.addEventListener('change',e=>{carWrap.style.display=e.target.value==='ì˜ˆ'?'block':'none'});
  form.addEventListener('submit',e=>{
    e.preventDefault(); if(!form.reportValidity()) return;
    const fd=new FormData(form); const targets=[...form.querySelectorAll('input[name="target"]:checked')].map(x=>x.value);
    const data={
      id:'SUB'+Date.now(), createdAt:todaySeoul().toISOString(),
      org:fd.get('org')?.trim(), aff:fd.get('aff')?.trim(), headcount:fd.get('headcount')?.trim(),
      leader:fd.get('leader')?.trim(), phone:fd.get('phone')?.trim(), email:fd.get('email')?.trim(),
      carUse:fd.get('carUse'), carNo:fd.get('carNo')?.trim(), date:fd.get('date'), time:fd.get('time'),
      targets, request:fd.get('request')?.trim(), agree:!!fd.get('agree'), status:'ì‹ ê·œ'
    };
    if(!validateDateRule(data.date)){ alert('ì„ íƒí•œ ë‚ ì§œê°€ ê·œì •(30ì¼ ì´í›„, í™”/ê¸ˆ)ì— ë§ì§€ ì•ŠìŠµë‹ˆë‹¤.'); return; }
    if(targets.length===0){ alert('ì°¸ê°€ ëŒ€ìƒì„ 1ê°œ ì´ìƒ ì„ íƒí•´ì£¼ì„¸ìš”.'); return; }
    addSubmission(data);
    const msg=$('#submitMsg',wrap); msg.style.display='block';
    msg.textContent='ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹´ë‹¹ì í™•ì¸ í›„ ìµœì¢… í™•ì • ì—°ë½ì„ ë“œë¦½ë‹ˆë‹¤.';
    form.reset(); carWrap.style.display='none'; buildDateOptions(dateSel);
  });
  $('#btnReset',wrap).addEventListener('click',()=>{ if(confirm('ì´ˆê¸°í™”í• ê¹Œìš”?')){ form.reset(); carWrap.style.display='none'; buildDateOptions(dateSel); $('#submitMsg',wrap).style.display='none'; }});
  return wrap;
}

/* ===== ê´€ë¦¬ì ===== */
function renderTable(){
  const q=($('#q')?.value||'').toLowerCase(), f=$('#statusFilter').value, tb=$('#tbody'), L=loadAll();
  tb.innerHTML='';
  L.filter(r=>{
    const hit=[r.org,r.aff,r.leader,r.phone,r.email,r.date,r.time].join(' ').toLowerCase();
    return (!q||hit.includes(q)) && (!f||r.status===f);
  }).forEach(r=>{
    const tr=document.createElement('tr'); tr.className='rowcard';
    tr.innerHTML=`
      <td><span class="status ${r.status==='ì‹ ê·œ'?'s-new':r.status==='í™•ì •'?'s-ok':'s-rej'}">${r.status}</span></td>
      <td><div>${fmt(r.createdAt)}</div><div class="mini">${r.id}</div></td>
      <td>${r.date} Â· ${r.time}</td>
      <td><strong>${escapeHtml(r.org||'')}</strong><div class="mini">${escapeHtml(r.aff||'')}</div></td>
      <td>${escapeHtml(r.leader||'')}</td>
      <td><div>${escapeHtml(r.phone||'')}</div><div class="mini">${escapeHtml(r.email||'')}</div></td>
      <td>${r.carUse}${r.carNo?' / '+escapeHtml(r.carNo):''}</td>
      <td>
        <div class="toolbar">
          <button class="admin-btn" data-action="status" data-id="${r.id}" data-val="í™•ì •">í™•ì •</button>
          <button class="admin-btn" data-action="status" data-id="${r.id}" data-val="ë°˜ë ¤">ë°˜ë ¤</button>
          <button class="admin-btn" data-action="status" data-id="${r.id}" data-val="ì‹ ê·œ">ì‹ ê·œ</button>
          <button class="admin-btn" data-action="del" data-id="${r.id}">ì‚­ì œ</button>
          <button class="admin-btn" data-action="view" data-id="${r.id}">ë³´ê¸°</button>
        </div>
      </td>`;
    tb.appendChild(tr);
  });
}
function exportCSV(){
  const rows=loadAll(), header=['id','status','createdAt','date','time','org','aff','headcount','leader','phone','email','carUse','carNo','targets','request'];
  const csv=[header.join(',')].concat(rows.map(r=>header.map(k=>`"${((''+(k==='targets'?(r[k]||[]).join('; '):r[k]??'')).replace(/"/g,'""'))}"`).join(','))).join('\r\n');
  const blob=new Blob([csv],{type:'text/csv;charset=utf-8;'}), url=URL.createObjectURL(blob); const a=document.createElement('a');
  a.href=url; a.download='cpbc_tour_submissions.csv'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
}

/* ===== ìŠ¬ë¼ì´ë“œ ë‚´ë¹„ ===== */
function setupSlides(){
  const scroller=$('#slides'); const slides=$$('.slide',scroller);
  // ì  ìƒì„±
  const dots=$('#dots'); dots.innerHTML=''; slides.forEach((_,i)=>{const d=document.createElement('div'); d.className='dot'+(i===0?' active':''); dots.appendChild(d);});
  const tabbar=$('#tabbar'); tabbar.addEventListener('click',e=>{
    const btn=e.target.closest('button[data-go]'); if(!btn) return;
    const idx=+btn.dataset.go; const target=slides[idx]; if(!target) return;
    target.scrollIntoView({behavior:'smooth', inline:'start', block:'nearest'});
  });
  const btns=$$('button[data-go]',tabbar); const dotEls=$$('.dot',dots);

  let ticking=false;
  scroller.addEventListener('scroll',()=>{
    if(ticking) return; ticking=true; requestAnimationFrame(()=>{
      // í˜„ì¬ ìŠ¬ë¼ì´ë“œ ì¸ë±ìŠ¤ ê³„ì‚°(ê°€ìš´ë° ê¸°ì¤€)
      const x=scroller.scrollLeft, w=scroller.clientWidth;
      const idx=Math.round(x/(w+16)); // gap ê³ ë ¤
      btns.forEach((b,i)=>b.classList.toggle('active',i===idx));
      dotEls.forEach((d,i)=>d.classList.toggle('active',i===idx));
      ticking=false;
    });
  },{passive:true});
}

/* ===== ì´ˆê¸°í™” ===== */
document.addEventListener('DOMContentLoaded',()=>{
  // í¼ mount (ë°ìŠ¤í¬í†±/ëª¨ë°”ì¼ ë‘˜ ë‹¤)
  $('#formMountDesktop').appendChild(createForm());
  $('#formMountMobile').appendChild(createForm());

  // ëª¨ë‹¬
  $('#openCarlo')?.addEventListener('click',()=>$('#carloDlg').showModal());
  $('#openCarloM')?.addEventListener('click',()=>$('#carloDlg').showModal());

  // ê´€ë¦¬ì
  $('#btnAdmin').addEventListener('click',()=>$('#adminDlg').showModal());
  $('#btnUnlock').addEventListener('click',()=>{
    const ok=$('#pinInput').value===ADMIN_PIN; $('#pinMsg').textContent=ok?'ì ‘ì† ì„±ê³µ':'PIN ë¶ˆì¼ì¹˜';
    $('#adminArea').style.display=ok?'block':'none'; if(ok) renderTable();
  });
  $('#q').addEventListener('input',renderTable);
  $('#statusFilter').addEventListener('change',renderTable);
  $('#btnExport').addEventListener('click',exportCSV);
  $('#btnClear').addEventListener('click',()=>{ if(confirm('ì •ë§ ì „ì²´ ì‚­ì œ?')){ saveAll([]); renderTable(); }});
  $('#tbody').addEventListener('click',e=>{
    const btn=e.target.closest('button[data-action]'); if(!btn) return;
    const id=btn.dataset.id, act=btn.dataset.action; const L=loadAll(); const i=L.findIndex(x=>x.id===id); if(i<0) return;
    if(act==='status'){ L[i].status=btn.dataset.val; saveAll(L); renderTable(); }
    else if(act==='del'){ if(confirm('ì‚­ì œí• ê¹Œìš”?')){ L.splice(i,1); saveAll(L); renderTable(); } }
    else if(act==='view'){ const r=L[i];
      alert(`[ìƒì„¸]
ìƒíƒœ: ${r.status}
ì‹ ì²­ì¼ì‹œ: ${fmt(r.createdAt)}
í¬ë§: ${r.date} ${r.time}
ë‹¨ì²´: ${r.org} / ${r.aff}
ì¸ì›: ${r.headcount}
ì¸ì†”ì: ${r.leader} / ${r.phone} / ${r.email}
ì°¨ëŸ‰: ${r.carUse}${r.carNo?' / '+r.carNo:''}
ëŒ€ìƒ: ${(r.targets||[]).join(', ')}
ìš”ì²­: ${r.request||''}`); }
  });

  // ìŠ¬ë¼ì´ë“œ ë‚´ë¹„
  setupSlides();
});
</script>
</body>
</html>
